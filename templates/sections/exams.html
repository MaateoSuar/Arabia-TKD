<div class="panel martial-panel">
  <div class="panel-content">
    <div class="section-header">
      <h3 class="section-heading">Exámenes</h3>
    </div>

    <div class="exams-layout">
      <!-- Columna izquierda: sólo datos del examen -->
      <section class="exams-column exams-column-left">
        <h4 class="subheading">Agendar examen</h4>
        <form id="exam-form" class="martial-form">
          <div class="form-grid">
            <label class="form-field">
              <span>Fecha</span>
              <input id="exam-date" type="hidden" required />
              <button type="button" id="exam-date-display" class="picker-display">Seleccionar fecha</button>
              <div id="exam-date-popover" class="picker-popover hidden">
                <div class="picker-popover-inner">
                  <div id="exam-date-calendar" class="exam-inline-calendar"></div>
                  <div class="picker-popover-actions">
                    <button type="button" class="btn-secondary" data-picker="date-cancel">Cancelar</button>
                    <button type="button" class="btn-martial" data-picker="date-apply">Aceptar</button>
                  </div>
                </div>
              </div>
            </label>
            <label class="form-field">
              <span>Horario</span>
              <button type="button" id="exam-time-display" class="picker-display">Seleccionar horario</button>
              <div id="exam-time-popover" class="picker-popover hidden">
                <div class="picker-popover-inner exam-time-picker">
                  <div class="exam-time-picker-row">
                    <span class="exam-time-label">Hora</span>
                    <input id="exam-time-hour" type="text" inputmode="numeric" maxlength="2" placeholder="HH" />
                  </div>
                  <div class="exam-time-picker-row">
                    <span class="exam-time-label">Minutos</span>
                    <input id="exam-time-minute" type="text" inputmode="numeric" maxlength="2" placeholder="MM" />
                  </div>
                  <small class="text-muted">Formato 24 hs (ej: 18:30)</small>
                  <input id="exam-time" type="hidden" required />
                  <div class="picker-popover-actions">
                    <button type="button" class="btn-secondary" data-picker="time-cancel">Cancelar</button>
                    <button type="button" class="btn-martial" data-picker="time-apply">Aceptar</button>
                  </div>
                </div>
              </div>
            </label>
            <!-- Ya no usamos graduación/cinturón/Gup en el examen, se calcula por alumno -->
            <label class="form-field">
              <span>Lugar</span>
              <input id="exam-place" type="text" required />
            </label>
            <label class="form-field form-field-full">
              <span>Notas u observaciones</span>
              <textarea id="exam-notes" rows="3"></textarea>
            </label>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-martial">Agendar examen</button>
          </div>
        </form>
      </section>

      <!-- Columna derecha: exámenes agendados + alumnos que rinden -->
      <section class="exams-column exams-column-right">
        <h4 class="subheading">Exámenes agendados</h4>
        <ul id="exams-list" class="exams-list"></ul>

        <div class="exam-pdf-box" id="exam-pdf-box" data-event-id="">
          <p class="exam-pdf-text">
            Seleccioná un examen de la lista y luego configurá qué alumnos rinden ese día.
          </p>

          <div class="exam-pdf-actions">
            <button id="btn-open-exam-students" class="btn-martial" disabled>
              Configurar alumnos que rinden
            </button>
            <button id="btn-generate-exam-rinde-pdf" class="btn-secondary" disabled>
              Generar PDF de rendida
            </button>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Modal: alumnos que rinden el examen -->
  <div id="modal-exam-students" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 class="section-heading">Alumnos que rinden este examen</h3>
        <button id="btn-close-exam-students" class="btn-icon">✕</button>
      </div>
      <div class="martial-form">
        <p class="text-muted">
          Marcá todos los alumnos que van a rendir en este examen. Podés seleccionar varios por vez y guardar la lista cuando termines.
        </p>
        <div id="exam-students-notice" class="inline-notice hidden"></div>
        <div class="table-wrapper">
          <table class="students-table">
            <thead>
              <tr>
                <th></th>
                <th>Apellido</th>
                <th>Nombre</th>
                <th>Cinturón actual</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="exam-students-tbody"></tbody>
          </table>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" id="btn-cancel-exam-students">Cancelar</button>
          <button type="button" class="btn-martial" id="btn-save-exam-students">Guardar alumnos</button>
        </div>
      </div>
    </div>
  </div>

  <div id="modal-exam-delete" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 class="section-heading">Eliminar examen</h3>
        <button id="btn-close-exam-delete" class="btn-icon">✕</button>
      </div>
      <div class="martial-form">
        <p class="text-muted" id="exam-delete-message">
          ¿Seguro que querés eliminar este examen agendado? Esta acción no se puede deshacer.
        </p>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" id="btn-cancel-exam-delete">Cancelar</button>
          <button type="button" class="btn-martial" id="btn-confirm-exam-delete">Eliminar</button>
        </div>
      </div>
    </div>
  </div>
</div>
